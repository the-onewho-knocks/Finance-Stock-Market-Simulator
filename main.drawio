<mxfile host="app.diagrams.net">
  <diagram name="Finance Simulation Runtime Architecture">
    <mxGraphModel dx="1400" dy="900" grid="1" gridSize="10">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- Client -->
        <mxCell id="client" value="Client&#10;(Web / Mobile / Postman)"
          style="rounded=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=14;"
          vertex="1" parent="1">
          <mxGeometry x="520" y="20" width="300" height="60"/>
        </mxCell>

        <!-- Router -->
        <mxCell id="router" value="Chi Router&#10;Routes + Middleware"
          style="rounded=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=14;"
          vertex="1" parent="1">
          <mxGeometry x="520" y="110" width="300" height="70"/>
        </mxCell>

        <!-- Handlers -->
        <mxCell id="handlers" value="Handlers&#10;Auth, User, Portfolio, Transaction, Expense, Market, Dashboard"
          style="rounded=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=13;"
          vertex="1" parent="1">
          <mxGeometry x="520" y="210" width="340" height="90"/>
        </mxCell>

        <!-- Services -->
        <mxCell id="services" value="Services (Business Logic)&#10;Auth, User, Portfolio, Transaction, Networth, Market, Dashboard"
          style="rounded=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=13;"
          vertex="1" parent="1">
          <mxGeometry x="480" y="330" width="420" height="100"/>
        </mxCell>

        <!-- Repositories -->
        <mxCell id="repos" value="Repositories (pgx)&#10;User, Admin, Portfolio, Transaction, Expense, PlannedExpense, Networth"
          style="rounded=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=12;"
          vertex="1" parent="1">
          <mxGeometry x="120" y="470" width="420" height="90"/>
        </mxCell>

        <!-- Cache -->
        <mxCell id="cache" value="Redis Cache&#10;Stock, Market, Heatmap, Dashboard"
          style="rounded=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=12;"
          vertex="1" parent="1">
          <mxGeometry x="760" y="470" width="360" height="90"/>
        </mxCell>

        <!-- PostgreSQL -->
        <mxCell id="postgres" value="PostgreSQL&#10;pgxpool"
          style="shape=cylinder;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;"
          vertex="1" parent="1">
          <mxGeometry x="180" y="610" width="300" height="100"/>
        </mxCell>

        <!-- External API -->
        <mxCell id="external" value="External Stock APIs&#10;RapidAPI Client"
          style="rounded=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;"
          vertex="1" parent="1">
          <mxGeometry x="540" y="610" width="360" height="100"/>
        </mxCell>

        <!-- Redis -->
        <mxCell id="redis" value="Redis"
          style="shape=cylinder;fillColor=#f8cecc;strokeColor=#b85450;fontSize=12;"
          vertex="1" parent="1">
          <mxGeometry x="820" y="610" width="240" height="100"/>
        </mxCell>

        <!-- Connections -->
        <mxCell edge="1" source="client" target="router" parent="1"/>
        <mxCell edge="1" source="router" target="handlers" parent="1"/>
        <mxCell edge="1" source="handlers" target="services" parent="1"/>
        <mxCell edge="1" source="services" target="repos" parent="1"/>
        <mxCell edge="1" source="services" target="cache" parent="1"/>
        <mxCell edge="1" source="repos" target="postgres" parent="1"/>
        <mxCell edge="1" source="services" target="external" parent="1"/>
        <mxCell edge="1" source="cache" target="redis" parent="1"/>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
